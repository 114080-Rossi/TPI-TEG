<div class="modal-overlay" *ngIf="open" (click)="onClose()">
  <div class="modal-window" (click)="$event.stopPropagation()">

    <h3>Asignar Ejércitos</h3>
    <p>Ejércitos disponibles: <b>{{ armiesLeft }}</b></p>

    <label>País:</label>
    <select [(ngModel)]="selectedCountryId" class="modal-input">
      <option [ngValue]="null" disabled selected>Elegí país</option>
      <option *ngFor="let c of countries" [ngValue]="c.id">{{ c.name }}</option>
    </select>

    <label>Cantidad:</label>
    <input type="number"
           class="modal-input"
           [(ngModel)]="assignedArmies"
           [min]="1"
           [max]="armiesLeft"
           [disabled]="!selectedCountryId || armiesLeft < 1" />

    <button class="modal-btn primary"
            (click)="assign()"
            [disabled]="!selectedCountryId || assignedArmies < 1 || assignedArmies > armiesLeft">
      Agregar
    </button>

    <hr />

    <div *ngIf="assignments.length > 0; else empty">
      <h4>Asignación actual</h4>
      <ul class="modal-list">
        <li *ngFor="let a of assignments; let i = index">
          <b>{{ a.countryName }}:</b> {{ a.armies }}
          <button class="remove" (click)="removeAssignment(i)">✖</button>
        </li>
      </ul>
    </div>
    <ng-template #empty>
      <span class="info">No asignaste ejércitos en esta tanda.</span>
    </ng-template>

    <div class="modal-btn-row">
      <button class="modal-btn primary"
              (click)="onConfirm()" [disabled]="assignments.length === 0">
        Confirmar tanda
      </button>
      <button class="modal-btn" (click)="onClose()">
        Cerrar
      </button>
    </div>
  </div>
</div>
